# ğŸ“Š Local Image Storage Architecture

## System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     PCN Vehicle Inventory                        â”‚
â”‚                     Local Image Storage System                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Add Vehicle â”‚       â”‚   Edit        â”‚       â”‚   View       â”‚
â”‚   Page        â”‚       â”‚   Vehicle     â”‚       â”‚   Vehicle    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                       â”‚                       â”‚
        â”‚ Upload                â”‚ Upload                â”‚ Display
        â”‚ Images                â”‚ More Images           â”‚ Images
        â”‚                       â”‚                       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  /api/upload           â”‚
                    â”‚  (Upload Handler)      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚               â”‚               â”‚
                â–¼               â–¼               â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Create       â”‚ â”‚ Save File    â”‚ â”‚ Return URL   â”‚
        â”‚ Directory    â”‚ â”‚ to Disk      â”‚ â”‚ Path         â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                                  â”‚
                                                  â–¼
                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                        â”‚ Save to Database â”‚
                                        â”‚ vehicle_images   â”‚
                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Upload Flow Diagram

```
User Action                 Frontend                Backend                 Storage
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                 â”€â”€â”€â”€â”€â”€â”€â”€                â”€â”€â”€â”€â”€â”€â”€                 â”€â”€â”€â”€â”€â”€â”€

1. Select Images
   ğŸ“ [Choose Files]
         â”‚
         â”‚
2. Submit Form
         â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º
         â”‚                   Create FormData
         â”‚                   â”œâ”€ file: File
         â”‚                   â”œâ”€ vehicleId: string
         â”‚                   â””â”€ imageType: string
         â”‚
         â”‚
3. POST /api/upload
         â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º
         â”‚                   â”‚                   Validate Request
         â”‚                   â”‚                   â”‚
         â”‚                   â”‚                   â”œâ”€ Check file exists
         â”‚                   â”‚                   â”œâ”€ Check vehicleId
         â”‚                   â”‚                   â””â”€ Check imageType
         â”‚                   â”‚
         â”‚                   â”‚                   Create Directory
         â”‚                   â”‚                   â”‚
         â”‚                   â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º
         â”‚                   â”‚                                       mkdir -p
         â”‚                   â”‚                                       /public/uploads/
         â”‚                   â”‚                                       vehicles/[id]/
         â”‚                   â”‚
         â”‚                   â”‚                   Write File
         â”‚                   â”‚                   â”‚
         â”‚                   â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º
         â”‚                   â”‚                                       Save to disk
         â”‚                   â”‚                                       [timestamp]-[name]
         â”‚                   â”‚
         â”‚                   â”‚                   â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         â”‚                   â”‚                   Success!
         â”‚                   â”‚
         â”‚                   â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         â”‚                   Return { url, fileName, fileSize }
         â”‚
         â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         Success!
         â”‚
         â”‚
4. Save to DB
         â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º
                             INSERT INTO vehicle_images
                             (vehicle_id, image_url, ...)
                             â”‚
                             â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                             Success!

5. Display Images
   ğŸ–¼ï¸ [Show in UI]
         â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º
                             <img src="/uploads/..." />
                                           â”‚
                                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º
                                                               Serve from
                                                               public/uploads/
```

## Directory Structure Evolution

```
Initial State:
dashboard/
â””â”€â”€ public/
    â””â”€â”€ uploads/
        â””â”€â”€ vehicles/
            â””â”€â”€ .gitkeep

After Adding Vehicle ID: abc-123
dashboard/
â””â”€â”€ public/
    â””â”€â”€ uploads/
        â””â”€â”€ vehicles/
            â”œâ”€â”€ .gitkeep
            â””â”€â”€ abc-123/                    â† Created automatically

After Uploading Gallery Image:
dashboard/
â””â”€â”€ public/
    â””â”€â”€ uploads/
        â””â”€â”€ vehicles/
            â”œâ”€â”€ .gitkeep
            â””â”€â”€ abc-123/
                â””â”€â”€ 1730123456-car-front.jpg    â† Gallery image

After Uploading CR Paper:
dashboard/
â””â”€â”€ public/
    â””â”€â”€ uploads/
        â””â”€â”€ vehicles/
            â”œâ”€â”€ .gitkeep
            â””â”€â”€ abc-123/
                â”œâ”€â”€ 1730123456-car-front.jpg
                â”œâ”€â”€ 1730123457-car-side.jpg
                â””â”€â”€ documents/                   â† Created automatically
                    â””â”€â”€ 1730123458-cr-paper.pdf â† CR document

After Adding Multiple Vehicles:
dashboard/
â””â”€â”€ public/
    â””â”€â”€ uploads/
        â””â”€â”€ vehicles/
            â”œâ”€â”€ .gitkeep
            â”œâ”€â”€ abc-123/
            â”‚   â”œâ”€â”€ 1730123456-car-front.jpg
            â”‚   â”œâ”€â”€ 1730123457-car-side.jpg
            â”‚   â””â”€â”€ documents/
            â”‚       â””â”€â”€ 1730123458-cr-paper.pdf
            â”œâ”€â”€ def-456/
            â”‚   â”œâ”€â”€ 1730123500-suv-front.jpg
            â”‚   â””â”€â”€ documents/
            â”‚       â””â”€â”€ 1730123501-registration.pdf
            â””â”€â”€ ghi-789/
                â”œâ”€â”€ 1730123600-sedan-1.jpg
                â”œâ”€â”€ 1730123601-sedan-2.jpg
                â””â”€â”€ 1730123602-sedan-3.jpg
```

## Data Flow: Add Vehicle

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 1: Vehicle Details Form                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Vehicle Number: _______________                          â”‚ â”‚
â”‚ â”‚ Brand: [Select]   Model: [Select]                        â”‚ â”‚
â”‚ â”‚ Year: ____   Country: [Select]                           â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 2: Upload Images                                        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ“ Vehicle Images: [Select Files]                        â”‚ â”‚
â”‚ â”‚    â”œâ”€ car-front.jpg  (2.3 MB)                           â”‚ â”‚
â”‚ â”‚    â”œâ”€ car-side.jpg   (1.8 MB)                           â”‚ â”‚
â”‚ â”‚    â””â”€ car-rear.jpg   (2.1 MB)                           â”‚ â”‚
â”‚ â”‚                                                           â”‚ â”‚
â”‚ â”‚ ğŸ“„ CR Paper: [Select File]                               â”‚ â”‚
â”‚ â”‚    â””â”€ registration.pdf  (0.5 MB)                        â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 3: Submit & Process                                     â”‚
â”‚                                                              â”‚
â”‚   [Publish Vehicle] Button Clicked                          â”‚
â”‚            â”‚                                                 â”‚
â”‚            â”œâ”€â”€â–º 1. Insert vehicle record to database        â”‚
â”‚            â”‚    â””â”€â–º Returns: vehicle_id = "abc-123"         â”‚
â”‚            â”‚                                                 â”‚
â”‚            â”œâ”€â”€â–º 2. Upload gallery images                    â”‚
â”‚            â”‚    â”œâ”€â–º POST /api/upload (car-front.jpg)        â”‚
â”‚            â”‚    â”‚   â””â”€â–º /uploads/vehicles/abc-123/17...jpg  â”‚
â”‚            â”‚    â”œâ”€â–º POST /api/upload (car-side.jpg)         â”‚
â”‚            â”‚    â”‚   â””â”€â–º /uploads/vehicles/abc-123/17...jpg  â”‚
â”‚            â”‚    â””â”€â–º POST /api/upload (car-rear.jpg)         â”‚
â”‚            â”‚        â””â”€â–º /uploads/vehicles/abc-123/17...jpg  â”‚
â”‚            â”‚                                                 â”‚
â”‚            â”œâ”€â”€â–º 3. Upload CR paper                          â”‚
â”‚            â”‚    â””â”€â–º POST /api/upload (registration.pdf)     â”‚
â”‚            â”‚        â””â”€â–º /uploads/.../documents/17...pdf     â”‚
â”‚            â”‚                                                 â”‚
â”‚            â””â”€â”€â–º 4. Save image records to database           â”‚
â”‚                 â””â”€â–º INSERT INTO vehicle_images (x4)         â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 4: Success!                                             â”‚
â”‚                                                              â”‚
â”‚  âœ… Vehicle Added Successfully!                              â”‚
â”‚  âœ… 3 Gallery Images Uploaded                                â”‚
â”‚  âœ… 1 CR Paper Uploaded                                      â”‚
â”‚  âœ… Ready to View in Inventory                               â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Image Display Flow

```
User Opens Vehicle Details
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Fetch vehicle data      â”‚
â”‚ from database           â”‚
â”‚                         â”‚
â”‚ SELECT * FROM vehicles  â”‚
â”‚ WHERE id = 'abc-123'    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Fetch image URLs        â”‚
â”‚ from database           â”‚
â”‚                         â”‚
â”‚ SELECT image_url        â”‚
â”‚ FROM vehicle_images     â”‚
â”‚ WHERE vehicle_id = ...  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Returns:                                 â”‚
â”‚ [                                        â”‚
â”‚   "/uploads/vehicles/abc-123/17...jpg", â”‚
â”‚   "/uploads/vehicles/abc-123/17...jpg", â”‚
â”‚   "/uploads/vehicles/abc-123/17...jpg"  â”‚
â”‚ ]                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Display in Modal/Carousel               â”‚
â”‚                                          â”‚
â”‚ <img src="/uploads/vehicles/..." />     â”‚
â”‚           â”‚                              â”‚
â”‚           â–¼                              â”‚
â”‚   Next.js serves from public/           â”‚
â”‚           â”‚                              â”‚
â”‚           â–¼                              â”‚
â”‚   Browser displays image                â”‚
â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Comparison: Before vs After

### Before (Supabase Storage)

```
User Upload
    â”‚
    â–¼
Upload to Supabase Storage
    â”‚
    â”œâ”€â–º Storage Bucket: "vehicle-images"
    â”‚   â””â”€â–º Cloud Storage (External)
    â”‚
    â–¼
Get Public URL
    â”‚
    â””â”€â–º https://xxx.supabase.co/storage/v1/object/public/...
         â”‚
         â–¼
    Save URL to Database
         â”‚
         â–¼
    Display: Fetch from Cloud
```

### After (Local Storage)

```
User Upload
    â”‚
    â–¼
Upload to Local API
    â”‚
    â”œâ”€â–º /api/upload
    â”‚   â””â”€â–º public/uploads/vehicles/ (Local Disk)
    â”‚
    â–¼
Get Local Path
    â”‚
    â””â”€â–º /uploads/vehicles/abc-123/...
         â”‚
         â–¼
    Save Path to Database
         â”‚
         â–¼
    Display: Serve from public/
```

## Component Integration

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    React Components                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AddVehiclePage   â”‚  â”‚ EditVehicleModal â”‚  â”‚ InventoryPage    â”‚
â”‚                  â”‚  â”‚                  â”‚  â”‚                  â”‚
â”‚ uploadImages()   â”‚  â”‚ uploadNewImages()â”‚  â”‚ fetchVehicle     â”‚
â”‚      â”‚           â”‚  â”‚      â”‚           â”‚  â”‚ Details()        â”‚
â”‚      â”‚           â”‚  â”‚      â”‚           â”‚  â”‚      â”‚           â”‚
â”‚      â–¼           â”‚  â”‚      â–¼           â”‚  â”‚      â–¼           â”‚
â”‚ POST /api/upload â”‚  â”‚ POST /api/upload â”‚  â”‚ Display images   â”‚
â”‚      â”‚           â”‚  â”‚      â”‚           â”‚  â”‚ from URLs        â”‚
â”‚      â–¼           â”‚  â”‚      â–¼           â”‚  â”‚                  â”‚
â”‚ Save to DB       â”‚  â”‚ Save to DB       â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     API Routes                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ /api/upload      â”‚  â”‚ /api/upload/     â”‚  â”‚ /uploads/...     â”‚
â”‚ (POST)           â”‚  â”‚ cleanup          â”‚  â”‚ (Static Files)   â”‚
â”‚                  â”‚  â”‚ (DELETE)         â”‚  â”‚                  â”‚
â”‚ â€¢ Receive file   â”‚  â”‚ â€¢ Delete vehicle â”‚  â”‚ â€¢ Served by      â”‚
â”‚ â€¢ Create dir     â”‚  â”‚   images folder  â”‚  â”‚   Next.js from   â”‚
â”‚ â€¢ Save to disk   â”‚  â”‚ â€¢ Clean up disk  â”‚  â”‚   public/        â”‚
â”‚ â€¢ Return URL     â”‚  â”‚   space          â”‚  â”‚                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    File System                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

public/uploads/vehicles/
â”œâ”€â”€ abc-123/
â”‚   â”œâ”€â”€ 1730123456-front.jpg  â†â”€â”€â”€â”€ Gallery Images
â”‚   â”œâ”€â”€ 1730123457-side.jpg
â”‚   â””â”€â”€ documents/
â”‚       â””â”€â”€ 1730123458-cr.pdf â†â”€â”€â”€â”€ CR Papers
â””â”€â”€ def-456/
    â””â”€â”€ 1730123500-suv.jpg

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Database                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

vehicles                          vehicle_images
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id: abc-123     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ vehicle_id: abc-123  â”‚
â”‚ vehicle_number  â”‚       â–²      â”‚ image_url: /uploads/ â”‚
â”‚ brand_id        â”‚       â”‚      â”‚ image_type: gallery  â”‚
â”‚ model_id        â”‚       â”‚      â”‚ display_order: 0     â”‚
â”‚ ...             â”‚       â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â””â”€â”€â”€â”€â”€â”€â”‚ vehicle_id: abc-123  â”‚
                                 â”‚ image_url: /uploads/ â”‚
                                 â”‚ image_type: cr_paper â”‚
                                 â”‚ display_order: 0     â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Summary

âœ… **Simple Architecture:** Upload â†’ Save â†’ Display  
âœ… **Local Storage:** Fast, no external dependencies  
âœ… **Database Sync:** URLs tracked in vehicle_images table  
âœ… **Automatic Cleanup:** Optional deletion on vehicle removal  
âœ… **Next.js Serving:** Files served from public/ directory  

**System is ready!** All images now save locally. ğŸ‰

---

**Architecture Version:** 1.0  
**Created:** October 28, 2025
